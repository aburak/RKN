Namespace(agg_weight=2.0, aggregation=False, alternating=False, batch_size=64, dataset='/scratch/256287/SCOP167-fold/', embedding='blosum62', epochs=100, gap_penalty=[0.0], gap_penalty_trainable=False, hidden_size=[800], kmer_size=[14], la_feature=None, lr=0.05, n_layers=1, n_sampling_patches=300000, outdir='', penalty='l2', pooling='max', pooling_arg=0.001, regularization=0.1, save_logs=False, seed=1, sigma=[0.4], tfid=[1], use_cuda=True)
tfid: a.102.4
tensor([0.])
Training layer 0
total number of patches: 300000
torch.Size([300000, 14, 20])
kmeans++
Spherical kmeans iter 10, objective value 12.722360610961914
Spherical kmeans iter 20, objective value 12.729104042053223
Spherical kmeans iter 30, objective value 12.731321334838867
Spherical kmeans iter 40, objective value 12.732427597045898
Spherical kmeans iter 50, objective value 12.733011245727539
Spherical kmeans iter 60, objective value 12.733373641967773
Spherical kmeans iter 70, objective value 12.733597755432129
Epoch 1/100
----------
current LR: 0.05
0.0
train Loss: 0.5684 Acc: 0.7247 Time: 36.72s
val Loss: 0.4973 Acc: 0.6944 Time: 4.24s

Epoch 2/100
----------
current LR: 0.05
0.0
train Loss: 0.5159 Acc: 0.7285 Time: 35.72s
val Loss: 0.5239 Acc: 0.6335 Time: 4.28s

Epoch 3/100
----------
current LR: 0.05
0.0
train Loss: 0.5261 Acc: 0.7209 Time: 35.72s
val Loss: 0.5537 Acc: 0.6192 Time: 4.24s

Epoch 4/100
----------
current LR: 0.05
0.0
train Loss: 0.5441 Acc: 0.6853 Time: 36.18s
val Loss: 0.4952 Acc: 0.7124 Time: 4.24s

Epoch 5/100
----------
current LR: 0.05
0.0
train Loss: 0.5319 Acc: 0.7107 Time: 36.08s
val Loss: 0.5171 Acc: 0.6419 Time: 4.24s

Epoch 6/100
----------
current LR: 0.05
0.0
train Loss: 0.5084 Acc: 0.7570 Time: 35.91s
val Loss: 0.4922 Acc: 0.7050 Time: 4.23s

Epoch 7/100
----------
current LR: 0.05
0.0
train Loss: 0.5109 Acc: 0.7413 Time: 35.79s
val Loss: 0.6923 Acc: 0.5122 Time: 4.23s

Epoch 8/100
----------
current LR: 0.05
0.0
train Loss: 0.5155 Acc: 0.7436 Time: 35.64s
val Loss: 0.5011 Acc: 0.6838 Time: 4.24s

Epoch 9/100
----------
current LR: 0.05
0.0
train Loss: 0.5120 Acc: 0.7312 Time: 35.80s
val Loss: 0.5039 Acc: 0.8803 Time: 4.23s

Epoch 10/100
----------
current LR: 0.05
0.0
train Loss: 0.5269 Acc: 0.7259 Time: 35.71s
val Loss: 0.5107 Acc: 0.6748 Time: 4.24s

Epoch 11/100
----------
current LR: 0.05
0.0
train Loss: 0.5069 Acc: 0.7625 Time: 35.90s
val Loss: 0.5044 Acc: 0.6928 Time: 4.23s

Epoch 12/100
----------
current LR: 0.05
0.0
train Loss: 0.5099 Acc: 0.7471 Time: 35.59s
val Loss: 0.5078 Acc: 0.6711 Time: 4.25s

Epoch 13/100
----------
current LR: 0.025
0.0
train Loss: 0.5029 Acc: 0.7577 Time: 36.12s
val Loss: 0.4978 Acc: 0.7924 Time: 4.23s

Epoch 14/100
----------
current LR: 0.025
0.0
train Loss: 0.4984 Acc: 0.7639 Time: 35.96s
val Loss: 0.4977 Acc: 0.7564 Time: 4.23s

Epoch 15/100
----------
current LR: 0.025
0.0
train Loss: 0.5020 Acc: 0.7651 Time: 35.72s
val Loss: 0.5040 Acc: 0.6875 Time: 4.23s

Epoch 16/100
----------
current LR: 0.025
0.0
train Loss: 0.5054 Acc: 0.7568 Time: 35.76s
val Loss: 0.4952 Acc: 0.7129 Time: 4.23s

Epoch 17/100
----------
current LR: 0.025
0.0
train Loss: 0.4958 Acc: 0.7670 Time: 35.95s
val Loss: 0.5147 Acc: 0.6578 Time: 4.24s

Epoch 18/100
----------
current LR: 0.025
0.0
train Loss: 0.5019 Acc: 0.7529 Time: 36.02s
val Loss: 0.5066 Acc: 0.8988 Time: 4.23s

Epoch 19/100
----------
current LR: 0.0125
0.0
train Loss: 0.4959 Acc: 0.7727 Time: 35.70s
val Loss: 0.5027 Acc: 0.6801 Time: 4.26s

Epoch 20/100
----------
current LR: 0.0125
0.0
train Loss: 0.4943 Acc: 0.7685 Time: 35.54s
val Loss: 0.5032 Acc: 0.8819 Time: 4.25s

Epoch 21/100
----------
current LR: 0.0125
0.0
train Loss: 0.4918 Acc: 0.7616 Time: 35.92s
val Loss: 0.5024 Acc: 0.6864 Time: 4.24s

Epoch 22/100
----------
current LR: 0.0125
0.0
train Loss: 0.4943 Acc: 0.7688 Time: 36.01s
val Loss: 0.5088 Acc: 0.6764 Time: 4.24s

Epoch 23/100
----------
current LR: 0.0125
0.0
train Loss: 0.4963 Acc: 0.7640 Time: 35.99s
val Loss: 0.4921 Acc: 0.7193 Time: 4.23s

Epoch 24/100
----------
current LR: 0.0125
0.0
train Loss: 0.4938 Acc: 0.7667 Time: 35.66s
val Loss: 0.5054 Acc: 0.8522 Time: 4.26s

Epoch 25/100
----------
current LR: 0.0125
0.0
train Loss: 0.4983 Acc: 0.7683 Time: 35.84s
val Loss: 0.5042 Acc: 0.7749 Time: 4.26s

Epoch 26/100
----------
current LR: 0.0125
0.0
train Loss: 0.5002 Acc: 0.7639 Time: 35.62s
val Loss: 0.5249 Acc: 0.6419 Time: 4.25s

Epoch 27/100
----------
current LR: 0.0125
0.0
train Loss: 0.4992 Acc: 0.7700 Time: 35.92s
val Loss: 0.4938 Acc: 0.7669 Time: 4.25s

Epoch 28/100
----------
current LR: 0.0125
0.0
train Loss: 0.4953 Acc: 0.7716 Time: 36.07s
val Loss: 0.5170 Acc: 0.6578 Time: 4.27s

Epoch 29/100
----------
current LR: 0.0125
0.0
train Loss: 0.4999 Acc: 0.7587 Time: 36.00s
val Loss: 0.4944 Acc: 0.7315 Time: 4.26s

Epoch 30/100
----------
current LR: 0.00625
0.0
train Loss: 0.4917 Acc: 0.7607 Time: 35.96s
val Loss: 0.4975 Acc: 0.7876 Time: 4.25s

Epoch 31/100
----------
current LR: 0.00625
0.0
train Loss: 0.4945 Acc: 0.7663 Time: 35.63s
val Loss: 0.4961 Acc: 0.7182 Time: 4.30s

Epoch 32/100
----------
current LR: 0.00625
0.0
train Loss: 0.4964 Acc: 0.7653 Time: 35.88s
val Loss: 0.4972 Acc: 0.7007 Time: 4.23s

Epoch 33/100
----------
current LR: 0.00625
0.0
train Loss: 0.4971 Acc: 0.7746 Time: 35.85s
val Loss: 0.4970 Acc: 0.7262 Time: 4.27s

Epoch 34/100
----------
current LR: 0.00625
0.0
train Loss: 0.4925 Acc: 0.7605 Time: 35.71s
val Loss: 0.4946 Acc: 0.7240 Time: 4.24s

Epoch 35/100
----------
current LR: 0.00625
0.0
train Loss: 0.4922 Acc: 0.7617 Time: 35.93s
val Loss: 0.4976 Acc: 0.7225 Time: 4.24s

Epoch 36/100
----------
current LR: 0.003125
0.0
train Loss: 0.4907 Acc: 0.7589 Time: 35.83s
val Loss: 0.4993 Acc: 0.7654 Time: 4.24s

Epoch 37/100
----------
current LR: 0.003125
0.0
train Loss: 0.4920 Acc: 0.7550 Time: 35.70s
val Loss: 0.5013 Acc: 0.8204 Time: 4.24s

Epoch 38/100
----------
current LR: 0.003125
0.0
train Loss: 0.4933 Acc: 0.7651 Time: 36.03s
val Loss: 0.4972 Acc: 0.7135 Time: 4.23s

Epoch 39/100
----------
current LR: 0.003125
0.0
train Loss: 0.4910 Acc: 0.7513 Time: 35.64s
val Loss: 0.4964 Acc: 0.7182 Time: 4.24s

Epoch 40/100
----------
current LR: 0.003125
0.0
train Loss: 0.4909 Acc: 0.7575 Time: 35.61s
val Loss: 0.4978 Acc: 0.7230 Time: 4.21s

Epoch 41/100
----------
current LR: 0.003125
0.0
train Loss: 0.4936 Acc: 0.7681 Time: 35.53s
val Loss: 0.5109 Acc: 0.9020 Time: 4.26s

Epoch 42/100
----------
current LR: 0.0015625
0.0
train Loss: 0.4915 Acc: 0.7596 Time: 35.64s
val Loss: 0.4979 Acc: 0.7680 Time: 4.24s

Epoch 43/100
----------
current LR: 0.0015625
0.0
train Loss: 0.4910 Acc: 0.7591 Time: 35.61s
val Loss: 0.4979 Acc: 0.7617 Time: 4.26s

Epoch 44/100
----------
current LR: 0.0015625
0.0
train Loss: 0.4913 Acc: 0.7503 Time: 35.89s
val Loss: 0.4968 Acc: 0.7548 Time: 4.26s

Epoch 45/100
----------
current LR: 0.0015625
0.0
train Loss: 0.4897 Acc: 0.7602 Time: 35.71s
val Loss: 0.4975 Acc: 0.7240 Time: 4.24s

Epoch 46/100
----------
current LR: 0.0015625
0.0
train Loss: 0.4913 Acc: 0.7506 Time: 35.59s
val Loss: 0.4995 Acc: 0.7908 Time: 4.24s

Epoch 47/100
----------
current LR: 0.0015625
0.0
train Loss: 0.4902 Acc: 0.7533 Time: 36.00s
val Loss: 0.4979 Acc: 0.7579 Time: 4.23s

Epoch 48/100
----------
current LR: 0.00078125
0.0
train Loss: 0.4897 Acc: 0.7519 Time: 35.95s
val Loss: 0.5003 Acc: 0.8008 Time: 4.26s

Epoch 49/100
----------
current LR: 0.00078125
0.0
train Loss: 0.4902 Acc: 0.7522 Time: 35.84s
val Loss: 0.4976 Acc: 0.7553 Time: 4.25s

Epoch 50/100
----------
current LR: 0.00078125
0.0
train Loss: 0.4899 Acc: 0.7533 Time: 35.82s
val Loss: 0.4971 Acc: 0.7389 Time: 4.29s

Epoch 51/100
----------
current LR: 0.00078125
0.0
train Loss: 0.4907 Acc: 0.7591 Time: 35.71s
val Loss: 0.4978 Acc: 0.7617 Time: 4.23s

Epoch 52/100
----------
current LR: 0.00078125
0.0
train Loss: 0.4900 Acc: 0.7504 Time: 35.85s
val Loss: 0.4974 Acc: 0.7574 Time: 4.20s

Epoch 53/100
----------
current LR: 0.00078125
0.0
train Loss: 0.4909 Acc: 0.7506 Time: 35.73s
val Loss: 0.4997 Acc: 0.7977 Time: 4.27s

Epoch 54/100
----------
current LR: 0.000390625
0.0
train Loss: 0.4895 Acc: 0.7552 Time: 36.03s
val Loss: 0.4987 Acc: 0.7775 Time: 4.24s

Epoch 55/100
----------
current LR: 0.000390625
0.0
train Loss: 0.4898 Acc: 0.7616 Time: 35.71s
val Loss: 0.4971 Acc: 0.7431 Time: 4.26s

Epoch 56/100
----------
current LR: 0.000390625
0.0
train Loss: 0.4896 Acc: 0.7520 Time: 35.90s
val Loss: 0.4975 Acc: 0.7574 Time: 4.24s

Epoch 57/100
----------
current LR: 0.000390625
0.0
train Loss: 0.4900 Acc: 0.7513 Time: 35.69s
val Loss: 0.4979 Acc: 0.7590 Time: 4.24s

Epoch 58/100
----------
current LR: 0.000390625
0.0
train Loss: 0.4898 Acc: 0.7527 Time: 35.94s
val Loss: 0.4973 Acc: 0.7505 Time: 4.22s

Epoch 59/100
----------
current LR: 0.000390625
0.0
train Loss: 0.4897 Acc: 0.7519 Time: 35.76s
val Loss: 0.4976 Acc: 0.7569 Time: 4.29s

Epoch 60/100
----------
current LR: 0.0001953125
0.0
train Loss: 0.4893 Acc: 0.7496 Time: 36.21s
val Loss: 0.4977 Acc: 0.7585 Time: 4.22s

Epoch 61/100
----------
current LR: 0.0001953125
0.0
train Loss: 0.4897 Acc: 0.7496 Time: 35.93s
val Loss: 0.4976 Acc: 0.7574 Time: 4.25s

Epoch 62/100
----------
current LR: 0.0001953125
0.0
train Loss: 0.4897 Acc: 0.7524 Time: 35.62s
val Loss: 0.4973 Acc: 0.7500 Time: 4.25s

Epoch 63/100
----------
current LR: 0.0001953125
0.0
train Loss: 0.4895 Acc: 0.7572 Time: 35.65s
val Loss: 0.4970 Acc: 0.7309 Time: 4.25s

Epoch 64/100
----------
current LR: 0.0001953125
0.0
train Loss: 0.4894 Acc: 0.7473 Time: 35.88s
val Loss: 0.4980 Acc: 0.7617 Time: 4.25s

Epoch 65/100
----------
current LR: 0.0001953125
0.0
train Loss: 0.4901 Acc: 0.7450 Time: 35.53s
val Loss: 0.4978 Acc: 0.7574 Time: 4.29s

Epoch 66/100
----------
current LR: 0.0001
0.0
train Loss: 0.4897 Acc: 0.7561 Time: 36.00s
val Loss: 0.4976 Acc: 0.7548 Time: 4.27s

Epoch 67/100
----------
current LR: 0.0001
0.0
train Loss: 0.4895 Acc: 0.7520 Time: 36.17s
val Loss: 0.4973 Acc: 0.7468 Time: 4.28s

Epoch 68/100
----------
current LR: 0.0001
0.0
train Loss: 0.4895 Acc: 0.7511 Time: 35.75s
val Loss: 0.4976 Acc: 0.7564 Time: 4.26s

Epoch 69/100
----------
current LR: 0.0001
0.0
train Loss: 0.4895 Acc: 0.7504 Time: 35.82s
val Loss: 0.4973 Acc: 0.7479 Time: 4.25s

Epoch 70/100
----------
current LR: 0.0001
0.0
train Loss: 0.4894 Acc: 0.7451 Time: 36.09s
val Loss: 0.4981 Acc: 0.7617 Time: 4.26s

Epoch 71/100
----------
current LR: 0.0001
0.0
train Loss: 0.4896 Acc: 0.7497 Time: 36.01s
val Loss: 0.4978 Acc: 0.7569 Time: 4.25s

Epoch 72/100
----------
current LR: 0.0001
0.0
train Loss: 0.4896 Acc: 0.7561 Time: 36.11s
val Loss: 0.4973 Acc: 0.7489 Time: 4.24s

Epoch 73/100
----------
current LR: 0.0001
0.0
train Loss: 0.4894 Acc: 0.7554 Time: 35.57s
val Loss: 0.4972 Acc: 0.7346 Time: 4.21s

Epoch 74/100
----------
current LR: 0.0001
0.0
train Loss: 0.4894 Acc: 0.7471 Time: 35.98s
val Loss: 0.4980 Acc: 0.7590 Time: 4.26s

Epoch 75/100
----------
current LR: 0.0001
0.0
train Loss: 0.4895 Acc: 0.7506 Time: 35.73s
val Loss: 0.4974 Acc: 0.7526 Time: 4.30s

Epoch 76/100
----------
current LR: 0.0001
0.0
train Loss: 0.4896 Acc: 0.7533 Time: 36.13s
val Loss: 0.4973 Acc: 0.7415 Time: 4.21s

Epoch 77/100
----------
current LR: 0.0001
0.0
train Loss: 0.4896 Acc: 0.7519 Time: 35.73s
val Loss: 0.4974 Acc: 0.7500 Time: 4.25s

Epoch 78/100
----------
current LR: 0.0001
0.0
train Loss: 0.4896 Acc: 0.7533 Time: 35.47s
val Loss: 0.4974 Acc: 0.7447 Time: 4.23s

Epoch 79/100
----------
current LR: 0.0001
0.0
train Loss: 0.4895 Acc: 0.7497 Time: 35.98s
val Loss: 0.4981 Acc: 0.7611 Time: 4.24s

Epoch 80/100
----------
current LR: 0.0001
0.0
train Loss: 0.4898 Acc: 0.7545 Time: 35.85s
val Loss: 0.4976 Acc: 0.7558 Time: 4.29s

Epoch 81/100
----------
current LR: 0.0001
0.0
train Loss: 0.4895 Acc: 0.7522 Time: 36.01s
val Loss: 0.4973 Acc: 0.7458 Time: 4.27s

Epoch 82/100
----------
current LR: 0.0001
0.0
train Loss: 0.4894 Acc: 0.7524 Time: 35.59s
val Loss: 0.4972 Acc: 0.7272 Time: 4.22s

Epoch 83/100
----------
current LR: 0.0001
0.0
train Loss: 0.4895 Acc: 0.7393 Time: 35.62s
val Loss: 0.4979 Acc: 0.7585 Time: 4.27s

Epoch 84/100
----------
current LR: 0.0001
0.0
train Loss: 0.4897 Acc: 0.7584 Time: 36.26s
val Loss: 0.4973 Acc: 0.7526 Time: 4.30s

Epoch 85/100
----------
current LR: 0.0001
0.0
train Loss: 0.4895 Acc: 0.7494 Time: 36.06s
val Loss: 0.4974 Acc: 0.7526 Time: 4.28s

Epoch 86/100
----------
current LR: 0.0001
0.0
train Loss: 0.4895 Acc: 0.7480 Time: 35.86s
val Loss: 0.4976 Acc: 0.7558 Time: 4.26s

Epoch 87/100
----------
current LR: 0.0001
0.0
train Loss: 0.4896 Acc: 0.7501 Time: 35.82s
val Loss: 0.4982 Acc: 0.7638 Time: 4.24s

Epoch 88/100
----------
current LR: 0.0001
0.0
train Loss: 0.4895 Acc: 0.7474 Time: 35.69s
val Loss: 0.4977 Acc: 0.7574 Time: 4.23s

Epoch 89/100
----------
current LR: 0.0001
0.0
train Loss: 0.4895 Acc: 0.7563 Time: 35.63s
val Loss: 0.4976 Acc: 0.7558 Time: 4.28s

Epoch 90/100
----------
current LR: 0.0001
0.0
train Loss: 0.4895 Acc: 0.7511 Time: 35.68s
val Loss: 0.4973 Acc: 0.7468 Time: 4.25s

Epoch 91/100
----------
current LR: 0.0001
0.0
train Loss: 0.4894 Acc: 0.7473 Time: 35.51s
val Loss: 0.4975 Acc: 0.7548 Time: 4.26s

Epoch 92/100
----------
current LR: 0.0001
0.0
train Loss: 0.4895 Acc: 0.7517 Time: 35.80s
val Loss: 0.4976 Acc: 0.7558 Time: 4.27s

Epoch 93/100
----------
current LR: 0.0001
0.0
train Loss: 0.4895 Acc: 0.7550 Time: 35.74s
val Loss: 0.4972 Acc: 0.7394 Time: 4.25s

Epoch 94/100
----------
current LR: 0.0001
0.0
train Loss: 0.4894 Acc: 0.7478 Time: 36.22s
val Loss: 0.4980 Acc: 0.7617 Time: 4.25s

Epoch 95/100
----------
current LR: 0.0001
0.0
train Loss: 0.4894 Acc: 0.7513 Time: 35.67s
val Loss: 0.4973 Acc: 0.7442 Time: 4.24s

Epoch 96/100
----------
current LR: 0.0001
0.0
train Loss: 0.4894 Acc: 0.7469 Time: 35.91s
val Loss: 0.4979 Acc: 0.7590 Time: 4.24s

Epoch 97/100
----------
current LR: 0.0001
0.0
train Loss: 0.4896 Acc: 0.7494 Time: 35.87s
val Loss: 0.4979 Acc: 0.7574 Time: 4.25s

Epoch 98/100
----------
current LR: 0.0001
0.0
train Loss: 0.4896 Acc: 0.7545 Time: 35.88s
val Loss: 0.4975 Acc: 0.7553 Time: 4.25s

Epoch 99/100
----------
current LR: 0.0001
0.0
train Loss: 0.4895 Acc: 0.7510 Time: 35.86s
val Loss: 0.4973 Acc: 0.7505 Time: 4.25s

Epoch 100/100
----------
current LR: 0.0001
0.0
train Loss: 0.4896 Acc: 0.7464 Time: 35.80s
val Loss: 0.4977 Acc: 0.7574 Time: 4.27s

Best epoch: 23
Best val Acc: 0.719280
Best val loss: 0.492141
                      value
accuracy           0.188034
auPRC              0.558800
auROC              0.930046
auROC50            0.847500
log.loss           0.799142
pearson.p          0.000005
pearson.r          0.407784
recall_at_10_fdr   0.250000
recall_at_5_fdr    0.250000
spearman.p         0.000029
spearman.r         0.376005
train_time        68.120838
DONE!
