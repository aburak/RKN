Namespace(agg_weight=2.0, aggregation=False, alternating=False, batch_size=128, dataset='/scratch/256230/SCOP167-fold/', embedding='blosum62', epochs=100, gap_penalty=[0.0], gap_penalty_trainable=False, hidden_size=[650], kmer_size=[14], la_feature=None, lr=0.05, n_layers=1, n_sampling_patches=300000, outdir='', penalty='l2', pooling='max', pooling_arg=0.001, regularization=0.1, save_logs=False, seed=1, sigma=[0.4], tfid=[1], use_cuda=True)
tfid: a.102.4
tensor([0.])
Training layer 0
total number of patches: 300000
torch.Size([300000, 14, 20])
kmeans++
Spherical kmeans iter 10, objective value 12.70117473602295
Spherical kmeans iter 20, objective value 12.707869529724121
Spherical kmeans iter 30, objective value 12.71020221710205
Spherical kmeans iter 40, objective value 12.71147346496582
Spherical kmeans iter 50, objective value 12.712063789367676
Spherical kmeans iter 60, objective value 12.712492942810059
Spherical kmeans iter 70, objective value 12.712711334228516
Epoch 1/100
----------
current LR: 0.05
0.0
train Loss: 0.6300 Acc: 0.6582 Time: 17.15s
val Loss: 0.5381 Acc: 0.6224 Time: 3.23s

Epoch 2/100
----------
current LR: 0.05
0.0
train Loss: 0.5258 Acc: 0.7245 Time: 16.05s
val Loss: 0.5409 Acc: 0.6086 Time: 3.22s

Epoch 3/100
----------
current LR: 0.05
0.0
train Loss: 0.5275 Acc: 0.7358 Time: 15.79s
val Loss: 0.5182 Acc: 0.6668 Time: 3.22s

Epoch 4/100
----------
current LR: 0.05
0.0
train Loss: 0.5131 Acc: 0.7572 Time: 15.98s
val Loss: 0.5142 Acc: 0.6780 Time: 3.21s

Epoch 5/100
----------
current LR: 0.05
0.0
train Loss: 0.5147 Acc: 0.7398 Time: 16.01s
val Loss: 0.5052 Acc: 0.7161 Time: 3.20s

Epoch 6/100
----------
current LR: 0.05
0.0
train Loss: 0.5083 Acc: 0.7591 Time: 15.70s
val Loss: 0.5116 Acc: 0.7108 Time: 3.23s

Epoch 7/100
----------
current LR: 0.05
0.0
train Loss: 0.5082 Acc: 0.7587 Time: 15.99s
val Loss: 0.5123 Acc: 0.7092 Time: 3.22s

Epoch 8/100
----------
current LR: 0.05
0.0
train Loss: 0.5105 Acc: 0.7633 Time: 16.03s
val Loss: 0.5511 Acc: 0.5969 Time: 3.20s

Epoch 9/100
----------
current LR: 0.05
0.0
train Loss: 0.5418 Acc: 0.6925 Time: 15.98s
val Loss: 0.6067 Acc: 0.6065 Time: 3.21s

Epoch 10/100
----------
current LR: 0.05
0.0
train Loss: 0.5325 Acc: 0.7194 Time: 15.92s
val Loss: 0.5208 Acc: 0.9115 Time: 3.24s

Epoch 11/100
----------
current LR: 0.05
0.0
train Loss: 0.5153 Acc: 0.7529 Time: 16.16s
val Loss: 0.5147 Acc: 0.6843 Time: 3.24s

Epoch 12/100
----------
current LR: 0.025
0.0
train Loss: 0.5071 Acc: 0.7538 Time: 15.79s
val Loss: 0.5114 Acc: 0.7537 Time: 3.21s

Epoch 13/100
----------
current LR: 0.025
0.0
train Loss: 0.5068 Acc: 0.7547 Time: 16.00s
val Loss: 0.5179 Acc: 0.6727 Time: 3.23s

Epoch 14/100
----------
current LR: 0.025
0.0
train Loss: 0.5149 Acc: 0.7499 Time: 15.85s
val Loss: 0.5096 Acc: 0.6928 Time: 3.23s

Epoch 15/100
----------
current LR: 0.025
0.0
train Loss: 0.5114 Acc: 0.7617 Time: 15.86s
val Loss: 0.5069 Acc: 0.6986 Time: 3.23s

Epoch 16/100
----------
current LR: 0.025
0.0
train Loss: 0.5075 Acc: 0.7626 Time: 15.92s
val Loss: 0.5148 Acc: 0.7500 Time: 3.22s

Epoch 17/100
----------
current LR: 0.025
0.0
train Loss: 0.5073 Acc: 0.7526 Time: 16.02s
val Loss: 0.5245 Acc: 0.9121 Time: 3.26s

Epoch 18/100
----------
current LR: 0.0125
0.0
train Loss: 0.5068 Acc: 0.7529 Time: 15.97s
val Loss: 0.5085 Acc: 0.7299 Time: 3.24s

Epoch 19/100
----------
current LR: 0.0125
0.0
train Loss: 0.5074 Acc: 0.7501 Time: 15.94s
val Loss: 0.5207 Acc: 0.8644 Time: 3.24s

Epoch 20/100
----------
current LR: 0.0125
0.0
train Loss: 0.5079 Acc: 0.7632 Time: 16.13s
val Loss: 0.5111 Acc: 0.7532 Time: 3.24s

Epoch 21/100
----------
current LR: 0.0125
0.0
train Loss: 0.5084 Acc: 0.7474 Time: 15.92s
val Loss: 0.5220 Acc: 0.8882 Time: 3.22s

Epoch 22/100
----------
current LR: 0.0125
0.0
train Loss: 0.5047 Acc: 0.7545 Time: 15.87s
val Loss: 0.5121 Acc: 0.6849 Time: 3.22s

Epoch 23/100
----------
current LR: 0.0125
0.0
train Loss: 0.5054 Acc: 0.7492 Time: 15.94s
val Loss: 0.5172 Acc: 0.6727 Time: 3.24s

Epoch 24/100
----------
current LR: 0.00625
0.0
train Loss: 0.5047 Acc: 0.7416 Time: 15.84s
val Loss: 0.5227 Acc: 0.8819 Time: 3.22s

Epoch 25/100
----------
current LR: 0.00625
0.0
train Loss: 0.5061 Acc: 0.7547 Time: 15.95s
val Loss: 0.5103 Acc: 0.7532 Time: 3.21s

Epoch 26/100
----------
current LR: 0.00625
0.0
train Loss: 0.5030 Acc: 0.7407 Time: 16.18s
val Loss: 0.5103 Acc: 0.7479 Time: 3.23s

Epoch 27/100
----------
current LR: 0.00625
0.0
train Loss: 0.5066 Acc: 0.7471 Time: 15.99s
val Loss: 0.5083 Acc: 0.7230 Time: 3.21s

Epoch 28/100
----------
current LR: 0.00625
0.0
train Loss: 0.5019 Acc: 0.7499 Time: 16.03s
val Loss: 0.5122 Acc: 0.6849 Time: 3.23s

Epoch 29/100
----------
current LR: 0.00625
0.0
train Loss: 0.5044 Acc: 0.7342 Time: 16.07s
val Loss: 0.5122 Acc: 0.7887 Time: 3.21s

Epoch 30/100
----------
current LR: 0.003125
0.0
train Loss: 0.5035 Acc: 0.7511 Time: 16.03s
val Loss: 0.5093 Acc: 0.7193 Time: 3.24s

Epoch 31/100
----------
current LR: 0.003125
0.0
train Loss: 0.5021 Acc: 0.7390 Time: 15.88s
val Loss: 0.5097 Acc: 0.7463 Time: 3.24s

Epoch 32/100
----------
current LR: 0.003125
0.0
train Loss: 0.5039 Acc: 0.7363 Time: 16.00s
val Loss: 0.5112 Acc: 0.7611 Time: 3.24s

Epoch 33/100
----------
current LR: 0.003125
0.0
train Loss: 0.5029 Acc: 0.7536 Time: 15.96s
val Loss: 0.5097 Acc: 0.7119 Time: 3.26s

Epoch 34/100
----------
current LR: 0.003125
0.0
train Loss: 0.5032 Acc: 0.7416 Time: 16.09s
val Loss: 0.5094 Acc: 0.7357 Time: 3.22s

Epoch 35/100
----------
current LR: 0.003125
0.0
train Loss: 0.5028 Acc: 0.7351 Time: 15.98s
val Loss: 0.5123 Acc: 0.7733 Time: 3.22s

Epoch 36/100
----------
current LR: 0.0015625
0.0
train Loss: 0.5027 Acc: 0.7402 Time: 15.91s
val Loss: 0.5094 Acc: 0.7272 Time: 3.22s

Epoch 37/100
----------
current LR: 0.0015625
0.0
train Loss: 0.5034 Acc: 0.7406 Time: 15.97s
val Loss: 0.5099 Acc: 0.7362 Time: 3.24s

Epoch 38/100
----------
current LR: 0.0015625
0.0
train Loss: 0.5028 Acc: 0.7344 Time: 15.89s
val Loss: 0.5125 Acc: 0.7860 Time: 3.22s

Epoch 39/100
----------
current LR: 0.0015625
0.0
train Loss: 0.5024 Acc: 0.7390 Time: 16.02s
val Loss: 0.5096 Acc: 0.7415 Time: 3.20s

Epoch 40/100
----------
current LR: 0.0015625
0.0
train Loss: 0.5031 Acc: 0.7406 Time: 16.02s
val Loss: 0.5096 Acc: 0.7182 Time: 3.23s

Epoch 41/100
----------
current LR: 0.0015625
0.0
train Loss: 0.5029 Acc: 0.7423 Time: 16.01s
val Loss: 0.5103 Acc: 0.7500 Time: 3.22s

Epoch 42/100
----------
current LR: 0.00078125
0.0
train Loss: 0.5021 Acc: 0.7335 Time: 15.88s
val Loss: 0.5095 Acc: 0.7272 Time: 3.23s

Epoch 43/100
----------
current LR: 0.00078125
0.0
train Loss: 0.5025 Acc: 0.7499 Time: 15.90s
val Loss: 0.5095 Acc: 0.7256 Time: 3.25s

Epoch 44/100
----------
current LR: 0.00078125
0.0
train Loss: 0.5025 Acc: 0.7391 Time: 15.94s
val Loss: 0.5097 Acc: 0.7415 Time: 3.26s

Epoch 45/100
----------
current LR: 0.00078125
0.0
train Loss: 0.5020 Acc: 0.7487 Time: 16.06s
val Loss: 0.5096 Acc: 0.7150 Time: 3.22s

Epoch 46/100
----------
current LR: 0.00078125
0.0
train Loss: 0.5023 Acc: 0.7345 Time: 15.98s
val Loss: 0.5096 Acc: 0.7357 Time: 3.24s

Epoch 47/100
----------
current LR: 0.00078125
0.0
train Loss: 0.5021 Acc: 0.7437 Time: 16.01s
val Loss: 0.5095 Acc: 0.7293 Time: 3.23s

Epoch 48/100
----------
current LR: 0.000390625
0.0
train Loss: 0.5020 Acc: 0.7372 Time: 15.94s
val Loss: 0.5098 Acc: 0.7415 Time: 3.26s

Epoch 49/100
----------
current LR: 0.000390625
0.0
train Loss: 0.5021 Acc: 0.7400 Time: 16.17s
val Loss: 0.5100 Acc: 0.7463 Time: 3.21s

Epoch 50/100
----------
current LR: 0.000390625
0.0
train Loss: 0.5026 Acc: 0.7492 Time: 16.04s
val Loss: 0.5098 Acc: 0.7421 Time: 3.22s

Epoch 51/100
----------
current LR: 0.000390625
0.0
train Loss: 0.5019 Acc: 0.7342 Time: 16.07s
val Loss: 0.5102 Acc: 0.7526 Time: 3.26s

Epoch 52/100
----------
current LR: 0.000390625
0.0
train Loss: 0.5023 Acc: 0.7397 Time: 16.43s
val Loss: 0.5097 Acc: 0.7346 Time: 3.23s

Epoch 53/100
----------
current LR: 0.000390625
0.0
train Loss: 0.5026 Acc: 0.7451 Time: 15.97s
val Loss: 0.5101 Acc: 0.7484 Time: 3.19s

Epoch 54/100
----------
current LR: 0.0001953125
0.0
train Loss: 0.5023 Acc: 0.7451 Time: 16.04s
val Loss: 0.5096 Acc: 0.7320 Time: 3.25s

Epoch 55/100
----------
current LR: 0.0001953125
0.0
train Loss: 0.5021 Acc: 0.7411 Time: 16.11s
val Loss: 0.5098 Acc: 0.7415 Time: 3.29s

Epoch 56/100
----------
current LR: 0.0001953125
0.0
train Loss: 0.5024 Acc: 0.7453 Time: 15.89s
val Loss: 0.5097 Acc: 0.7320 Time: 3.23s

Epoch 57/100
----------
current LR: 0.0001953125
0.0
train Loss: 0.5024 Acc: 0.7437 Time: 15.95s
val Loss: 0.5099 Acc: 0.7415 Time: 3.24s

Epoch 58/100
----------
current LR: 0.0001953125
0.0
train Loss: 0.5021 Acc: 0.7443 Time: 15.85s
val Loss: 0.5097 Acc: 0.7357 Time: 3.22s

Epoch 59/100
----------
current LR: 0.0001953125
0.0
train Loss: 0.5022 Acc: 0.7404 Time: 15.98s
val Loss: 0.5100 Acc: 0.7452 Time: 3.22s

Epoch 60/100
----------
current LR: 0.0001
0.0
train Loss: 0.5020 Acc: 0.7384 Time: 15.94s
val Loss: 0.5097 Acc: 0.7373 Time: 3.21s

Epoch 61/100
----------
current LR: 0.0001
0.0
train Loss: 0.5021 Acc: 0.7397 Time: 16.09s
val Loss: 0.5099 Acc: 0.7415 Time: 3.26s

Epoch 62/100
----------
current LR: 0.0001
0.0
train Loss: 0.5021 Acc: 0.7421 Time: 15.90s
val Loss: 0.5099 Acc: 0.7426 Time: 3.23s

Epoch 63/100
----------
current LR: 0.0001
0.0
train Loss: 0.5023 Acc: 0.7480 Time: 16.10s
val Loss: 0.5099 Acc: 0.7431 Time: 3.21s

Epoch 64/100
----------
current LR: 0.0001
0.0
train Loss: 0.5021 Acc: 0.7368 Time: 15.87s
val Loss: 0.5097 Acc: 0.7320 Time: 3.25s

Epoch 65/100
----------
current LR: 0.0001
0.0
train Loss: 0.5021 Acc: 0.7358 Time: 16.06s
val Loss: 0.5099 Acc: 0.7415 Time: 3.22s

Epoch 66/100
----------
current LR: 0.0001
0.0
train Loss: 0.5022 Acc: 0.7349 Time: 15.89s
val Loss: 0.5099 Acc: 0.7415 Time: 3.23s

Epoch 67/100
----------
current LR: 0.0001
0.0
train Loss: 0.5022 Acc: 0.7439 Time: 15.92s
val Loss: 0.5100 Acc: 0.7436 Time: 3.24s

Epoch 68/100
----------
current LR: 0.0001
0.0
train Loss: 0.5021 Acc: 0.7391 Time: 16.03s
val Loss: 0.5098 Acc: 0.7368 Time: 3.24s

Epoch 69/100
----------
current LR: 0.0001
0.0
train Loss: 0.5022 Acc: 0.7402 Time: 15.95s
val Loss: 0.5098 Acc: 0.7373 Time: 3.24s

Epoch 70/100
----------
current LR: 0.0001
0.0
train Loss: 0.5021 Acc: 0.7383 Time: 16.04s
val Loss: 0.5099 Acc: 0.7426 Time: 3.24s

Epoch 71/100
----------
current LR: 0.0001
0.0
train Loss: 0.5022 Acc: 0.7437 Time: 16.02s
val Loss: 0.5098 Acc: 0.7410 Time: 3.25s

Epoch 72/100
----------
current LR: 0.0001
0.0
train Loss: 0.5022 Acc: 0.7395 Time: 15.86s
val Loss: 0.5097 Acc: 0.7325 Time: 3.23s

Epoch 73/100
----------
current LR: 0.0001
0.0
train Loss: 0.5021 Acc: 0.7361 Time: 15.98s
val Loss: 0.5098 Acc: 0.7373 Time: 3.24s

Epoch 74/100
----------
current LR: 0.0001
0.0
train Loss: 0.5022 Acc: 0.7365 Time: 15.90s
val Loss: 0.5099 Acc: 0.7373 Time: 3.27s

Epoch 75/100
----------
current LR: 0.0001
0.0
train Loss: 0.5022 Acc: 0.7421 Time: 16.02s
val Loss: 0.5100 Acc: 0.7421 Time: 3.26s

Epoch 76/100
----------
current LR: 0.0001
0.0
train Loss: 0.5022 Acc: 0.7377 Time: 16.15s
val Loss: 0.5099 Acc: 0.7415 Time: 3.24s

Epoch 77/100
----------
current LR: 0.0001
0.0
train Loss: 0.5022 Acc: 0.7367 Time: 16.08s
val Loss: 0.5100 Acc: 0.7415 Time: 3.23s

Epoch 78/100
----------
current LR: 0.0001
0.0
train Loss: 0.5023 Acc: 0.7397 Time: 16.00s
val Loss: 0.5100 Acc: 0.7415 Time: 3.24s

Epoch 79/100
----------
current LR: 0.0001
0.0
train Loss: 0.5022 Acc: 0.7391 Time: 16.13s
val Loss: 0.5100 Acc: 0.7436 Time: 3.24s

Epoch 80/100
----------
current LR: 0.0001
0.0
train Loss: 0.5023 Acc: 0.7480 Time: 15.94s
val Loss: 0.5099 Acc: 0.7415 Time: 3.25s

Epoch 81/100
----------
current LR: 0.0001
0.0
train Loss: 0.5021 Acc: 0.7356 Time: 15.93s
val Loss: 0.5098 Acc: 0.7410 Time: 3.22s

Epoch 82/100
----------
current LR: 0.0001
0.0
train Loss: 0.5023 Acc: 0.7421 Time: 15.90s
val Loss: 0.5099 Acc: 0.7410 Time: 3.26s

Epoch 83/100
----------
current LR: 0.0001
0.0
train Loss: 0.5022 Acc: 0.7384 Time: 16.11s
val Loss: 0.5101 Acc: 0.7452 Time: 3.20s

Epoch 84/100
----------
current LR: 0.0001
0.0
train Loss: 0.5022 Acc: 0.7374 Time: 16.06s
val Loss: 0.5101 Acc: 0.7442 Time: 3.23s

Epoch 85/100
----------
current LR: 0.0001
0.0
train Loss: 0.5024 Acc: 0.7494 Time: 16.00s
val Loss: 0.5099 Acc: 0.7389 Time: 3.23s

Epoch 86/100
----------
current LR: 0.0001
0.0
train Loss: 0.5022 Acc: 0.7363 Time: 16.00s
val Loss: 0.5097 Acc: 0.7320 Time: 3.24s

Epoch 87/100
----------
current LR: 0.0001
0.0
train Loss: 0.5023 Acc: 0.7423 Time: 16.00s
val Loss: 0.5098 Acc: 0.7373 Time: 3.22s

Epoch 88/100
----------
current LR: 0.0001
0.0
train Loss: 0.5022 Acc: 0.7360 Time: 15.98s
val Loss: 0.5097 Acc: 0.7320 Time: 3.25s

Epoch 89/100
----------
current LR: 0.0001
0.0
train Loss: 0.5023 Acc: 0.7397 Time: 16.09s
val Loss: 0.5098 Acc: 0.7368 Time: 3.23s

Epoch 90/100
----------
current LR: 0.0001
0.0
train Loss: 0.5021 Acc: 0.7305 Time: 15.92s
val Loss: 0.5098 Acc: 0.7346 Time: 3.22s

Epoch 91/100
----------
current LR: 0.0001
0.0
train Loss: 0.5021 Acc: 0.7300 Time: 15.97s
val Loss: 0.5101 Acc: 0.7431 Time: 3.26s

Epoch 92/100
----------
current LR: 0.0001
0.0
train Loss: 0.5023 Acc: 0.7464 Time: 16.01s
val Loss: 0.5100 Acc: 0.7415 Time: 3.23s

Epoch 93/100
----------
current LR: 0.0001
0.0
train Loss: 0.5023 Acc: 0.7375 Time: 16.03s
val Loss: 0.5100 Acc: 0.7415 Time: 3.26s

Epoch 94/100
----------
current LR: 0.0001
0.0
train Loss: 0.5023 Acc: 0.7421 Time: 16.01s
val Loss: 0.5099 Acc: 0.7383 Time: 3.23s

Epoch 95/100
----------
current LR: 0.0001
0.0
train Loss: 0.5022 Acc: 0.7331 Time: 16.12s
val Loss: 0.5102 Acc: 0.7452 Time: 3.27s

Epoch 96/100
----------
current LR: 0.0001
0.0
train Loss: 0.5024 Acc: 0.7411 Time: 15.83s
val Loss: 0.5101 Acc: 0.7415 Time: 3.21s

Epoch 97/100
----------
current LR: 0.0001
0.0
train Loss: 0.5024 Acc: 0.7390 Time: 16.08s
val Loss: 0.5102 Acc: 0.7463 Time: 3.23s

Epoch 98/100
----------
current LR: 0.0001
0.0
train Loss: 0.5023 Acc: 0.7420 Time: 16.11s
val Loss: 0.5100 Acc: 0.7415 Time: 3.23s

Epoch 99/100
----------
current LR: 0.0001
0.0
train Loss: 0.5022 Acc: 0.7360 Time: 16.02s
val Loss: 0.5099 Acc: 0.7373 Time: 3.26s

Epoch 100/100
----------
current LR: 0.0001
0.0
train Loss: 0.5025 Acc: 0.7519 Time: 15.91s
val Loss: 0.5099 Acc: 0.7378 Time: 3.23s

Best epoch: 5
Best val Acc: 0.716102
Best val loss: 0.505230
                      value
accuracy           0.170940
auPRC              0.612811
auROC              0.920872
auROC50            0.827500
log.loss           0.799707
pearson.p          0.000011
pearson.r          0.393453
recall_at_10_fdr   0.250000
recall_at_5_fdr    0.250000
spearman.p         0.000045
spearman.r         0.367984
train_time        33.255514
DONE!
